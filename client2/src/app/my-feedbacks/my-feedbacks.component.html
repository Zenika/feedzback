<h1 class="gbl-page-title"><mat-icon>forum</mat-icon> Mes feedZbacks</h1>

<mat-tab-group animationDuration="0ms" [selectedIndex]="tabIndex" (selectedTabChange)="onTabIndexChange($event.index)">
  <mat-tab label="reçus">
    <ng-container
      [ngTemplateOutlet]="table"
      [ngTemplateOutletContext]="{ $implicit: receivedFeedbacks, type: feedbackType.received }"
    ></ng-container>
  </mat-tab>

  <mat-tab label="envoyés">
    <ng-container
      [ngTemplateOutlet]="table"
      [ngTemplateOutletContext]="{ $implicit: sentFeedbacks, type: feedbackType.sent }"
    ></ng-container>
  </mat-tab>
</mat-tab-group>

<ng-template #table let-feedbacks let-type="type" appMyFeedbacksTemplateContext>
  <div class="app-my-feedbacks__table-container">
    <table *ngIf="feedbacks.length; else noFeedbacks" mat-table [dataSource]="feedbacks">
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let element">{{ nf(element).email }}</td>
      </ng-container>

      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef>Date</th>
        <td mat-cell *matCellDef="let element">{{ nf(element).createdAt | date: 'shortDate' }}</td>
      </ng-container>

      <ng-container matColumnDef="mixed">
        <th mat-header-cell *matHeaderCellDef>
          <app-division a="Email" b="Date"></app-division>
        </th>
        <td mat-cell *matCellDef="let element" class="app-my-feedbacks__mobile">
          <strong>{{ nf(element).email }}</strong><br />
          <small>{{ nf(element).createdAt | date: 'shortDate' }}</small>
        </td>
      </ng-container>

      <ng-container matColumnDef="actions" stickyEnd>
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element" class="app-my-feedbacks-actions">
          <button
            mat-icon-button
            color="primary"
            matTooltip="Voir les détails du feedZback"
            matTooltipPosition="left"
            [routerLink]="['/feedback', nf(element).id, type]"
          >
            <mat-icon>visibility</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columns"></tr>
      <tr mat-row *matRowDef="let row; columns: columns"></tr>
    </table>
  </div>
</ng-template>

<ng-template #noFeedbacks>
  <div *ngIf="fetched" class="app-my-feedbacks__empty"><mat-icon>sentiment_dissatisfied</mat-icon> Aucun feedZback</div>
</ng-template>
