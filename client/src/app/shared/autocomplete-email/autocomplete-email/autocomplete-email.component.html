<mat-form-field appearance="outline" class="app-autocomplete-email__field">
  @if (forManager()) {
    <mat-label i18n="@@Field.EmailOfYourManager">Email de votre manager</mat-label>
  } @else {
    <mat-label i18n="@@Field.EmailOfYourColleague">Email de votre coll√®gue</mat-label>
  }

  <input
    #inputRef
    [formControl]="email()"
    type="email"
    matInput
    placeholder="jean.dupont@zenika.com"
    [matAutocomplete]="auto"
    (input)="updateQuery(inputRef.value)"
  />

  <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
    @for (result of queryResults$ | async; track result.email) {
      <mat-option [value]="result.email" (onSelectionChange)="selectEmail(result.email)">
        <div class="my-2 flex items-center gap-3">
          <app-avatar [photoUrl]="result.photoUrl" [name]="result.displayName" />

          <div>
            {{ result.displayName }}

            <div class="gbl-body-medium" style="color: var(--mat-sys-secondary)">{{ result.email }}</div>

            @if (result.managerEmail && showManagerEmail()) {
              <div class="gbl-body-small" style="color: var(--mat-sys-outline)">Manager: {{ result.managerEmail }}</div>
            }
          </div>
        </div>
      </mat-option>
    }
  </mat-autocomplete>

  <mat-error>{{ email().errors | validationErrorMessage }}</mat-error>
</mat-form-field>
