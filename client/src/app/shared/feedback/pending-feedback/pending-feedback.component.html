<h1 class="gbl-page-title">
  @switch (type) {
    @case (feedbackType.sentRequest) {
      <mat-icon>{{ 'sentRequest' | feedbackTypeIcon }}</mat-icon>
      <ng-container i18n="@@Title.RequestedFeedback">FeedZback demandé</ng-container>
    }
    @case (feedbackType.receivedRequest) {
      <mat-icon>{{ 'receivedRequest' | feedbackTypeIcon }}</mat-icon>
      <ng-container i18n="@@Title.FeedbackToGive">FeedZback à donner</ng-container>
    }
  }
</h1>

<ul class="gbl-icon-list gbl-icon-list--horizontal-md">
  <li class="gbl-icon-list__item">
    <mat-icon class="gbl-icon-list__icon">email</mat-icon>
    {{ getColleagueEmail(feedback) }}
  </li>

  <li class="gbl-icon-list__item">
    <mat-icon class="gbl-icon-list__icon">calendar_today</mat-icon>
    {{ feedback.createdAt | date: 'longDate' }}
  </li>
</ul>

<app-feedback-body [feedback]="feedback" />

@if (feedback.shared) {
  <ul class="gbl-icon-list gbl-icon-list--horizontal-md">
    <li class="gbl-icon-list__item">
      <mat-icon class="gbl-icon-list__icon">share</mat-icon>
      @if (type === feedbackType.sentRequest) {
        <ng-container i18n="@@Message.FeedbackIsSharedWithYourManager">
          Ce feedZback est partagé avec votre manager
        </ng-container>
      } @else {
        <ng-container i18n="@@Message.FeedbackIsSharedWithTheManagerOfYourColleague">
          Ce feedZback est partagé avec le manager de votre collègue
        </ng-container>
      }
    </li>
  </ul>
}

@switch (type) {
  @case (feedbackType.sentRequest) {
    @if (hasBeenRequestedAgain) {
      <ul class="gbl-icon-list gbl-icon-list--horizontal-md">
        <li class="gbl-icon-list__item">
          <mat-icon class="gbl-icon-list__icon">history</mat-icon>
          <ng-container i18n="@@Component.PendingFeedback.ReminderAlreadySentOn">
            Vous avez envoyé une relance à votre collègue le
          </ng-container>
          {{ feedback.updatedAt | date: 'longDate' }}
        </li>
      </ul>
    }

    @if (hasCancelRequestFeature && isRecentFeedbackRequest) {
      <ul class="gbl-icon-list gbl-icon-list--horizontal-md">
        <li class="gbl-icon-list__item">
          <mat-icon class="gbl-icon-list__icon">hourglass_top</mat-icon>
          <ng-container i18n="@@Component.PendingFeedback.CanNotBeCancelled">
            La demande est récente (moins de {{ DEADLINE_IN_DAYS }} jours) et ne peut pas encore être supprimée
          </ng-container>
        </li>
      </ul>
    }

    @if (actionsStatus !== 'hidden') {
      @if (!hasBeenRequestedAgain) {
        <button
          class="me-5"
          mat-raised-button
          color="primary"
          [disabled]="actionsStatus === 'disabled'"
          (click)="requestAgain()"
          i18n="@@Component.PendingFeedback.Remind"
        >
          Relancer
        </button>
      }

      @if (hasCancelRequestFeature && !isRecentFeedbackRequest) {
        <form
          class="inline"
          [formGroup]="cancelRequestForm"
          [appConfirmBeforeSubmit]="cancelRequest.bind(this)"
          appConfirmBeforeSubmitConfig="delete"
        >
          <button mat-button color="primary" [disabled]="actionsStatus === 'disabled'">
            <ng-container i18n="@@Action.Delete">Supprimer</ng-container>
          </button>
        </form>
      }
    }
  }
  @case (feedbackType.receivedRequest) {
    <button mat-raised-button color="primary" [appGiveRequestedFeedback]="this.feedback.id">
      <ng-container i18n="@@Feedback.Reply"> Répondre </ng-container>
    </button>
  }
}
